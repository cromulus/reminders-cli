# Reminders MCP Consolidation â€“ Specification

## Goal

Replace the fragmented Reminders MCP interface (11+ individual tools) with five cohesive, composable tools that provide richer functionality, advanced querying, and archive-aware operations tailored for LLM usage.

## New Tool Surface

1. `reminders_manage`  
   - Actions: `create`, `read`, `update`, `delete`, `complete`, `uncomplete`, `move`, `archive`.  
   - Inputs: Action selector plus action-specific payloads (nested structs).  
   - Outputs: Reminder details or success metadata depending on action.  
   - Smart parsing: reuses existing title/priority/date parsing helpers.  
   - Archive mode: moves reminders to an archive list (created/ensured separately).

2. `reminders_bulk`  
   - Actions: `update`, `complete`, `uncomplete`, `move`, `archive`, `delete`.  
   - Inputs: Array of UUIDs, optional fields (priority, completion state, target list, archive list, dryRun).  
   - Outputs: Batch success/failure counts, per-item errors, optional dry-run preview.

3. `reminders_search`  
   - Inputs: Declarative query DSL featuring logic trees (`all`, `any`, `xor`, `not`), comparison operators (`equals`, `contains`, `before`, `after`, `includes`, `excludes`, `exists`, etc.), grouping options (`priority`, `list`, `tag`, due-date granularity), multi-key sorting, pagination controls.  
   - Outputs: Matching reminders with optional grouped summaries and counts.

4. `reminders_lists`  
   - Actions: `list`, `create`, `delete`, `ensureArchive`.  
   - Inputs: Parameters specific to action (list identifier, name, source, archive name, createIfMissing).  
   - Outputs: Calendar data or success metadata.

5. `reminders_analyze`  
   - Modes: `overview` (mandatory), optional future extensions (`upcoming`, `priorityMatrix`, etc.).  
   - Outputs: Aggregated statistics (total, completed, incomplete, overdue, due today/this week, counts by priority/list/tag).

## Functional Requirements

- **Search DSL Support**  
  - Evaluate nested logical expressions, date comparisons, tag/list filters, text search across title and notes.  
  - Group results by requested fields and sort using ordered descriptors (e.g., priority desc, due date desc, created asc).  
  - Provide pagination (offset/limit) and total counts.

- **Archive Handling**  
  - Archive actions move reminders to a designated list.  
  - Server-side helper ensures archive list existence or returns actionable error instructing client to create/confirm.

- **Structured Validation**  
  - Request schemas must enforce required fields per action.  
  - Invalid combinations (e.g., missing UUID for update) raise `RemindersMCPError.invalidArguments`.

- **Natural-language Dates & Priority Parsing**  
  - Maintain existing natural-language parsing for due dates and flexible priority parsing in both single and bulk flows.

- **Dry Run for Bulk Operations**  
  - When `dryRun` is true, the server reports prospective changes without mutating reminders.

- **Documentation & Prompts**  
  - Update `API_DOCUMENTATION.md` and author a new reference describing tool schemas and query DSL.  
  - Include prompt recipes demonstrating common tasks (cleanup, weekly review, tag filtering, grouped reports).

## Non-Functional Requirements

- Build succeeds with SwiftMCP after removing deprecated tools.  
- JSON schemas generated by SwiftMCP reflect only the new tool methods.  
- Error messages remain concise and informative for LLM consumption.  
- Tests cover critical logic branches (manage actions, bulk success/failure, search filtering/sorting/grouping).

## Acceptance Criteria

1. Only five MCP tools (`reminders_manage`, `reminders_bulk`, `reminders_search`, `reminders_lists`, `reminders_analyze`) are registered.  
2. `reminders_manage` covers all required actions with smart parsing, archive support, and clear errors.  
3. `reminders_bulk` performs batch actions, supports dry-run, and returns accurate counts/errors.  
4. `reminders_search` executes the DSL with AND/OR/XOR/not, implements grouping/sorting/pagination, and passes unit tests demonstrating complex queries.  
5. `reminders_lists` manages calendars and can ensure/create archive lists with appropriate user-facing errors.  
6. `reminders_analyze` reproduces or improves existing overview statistics.  
7. Documentation and prompt recipes describing the new APIs are authored and linked from existing docs.  
8. Test suite (existing + new) and `swift build --product reminders-mcp` succeed.  
9. Legacy code paths removed; no deprecated tool references remain in docs or code.

